<!DOCTYPE html>
<html>
<head>
<title>XRX++ Unit Tests - xrx.drawing.ViewboxRotate</title>
<script src='../../../../lib/closure-library/closure/goog/base.js'></script>
<script src='../../../deps.js'></script>
<script src='./drawingViewbox_test.js'></script>
<link rel="stylesheet" type="text/css" href="./drawingViewbox_test.css">
<script type="text/javascript">
  goog.require('goog.testing.jsunit');
  goog.require('goog.dom.DomHelper');
  goog.require('goog.dom.forms');
  goog.require('goog.events');
  goog.require('goog.events.EventType');
  goog.require('goog.ui.Component.EventType');
  goog.require('goog.ui.Slider');
  goog.require('xrx');
</script>
</head>
<body>

<h1>Whether rotation works with all rendering engines</h1>
<table>
  <tr>
    <td></td>
    <td>Rotate Left</td>
    <td>Rotate Right</td>
  </tr>
  <tr>
    <td>SVG</td>
    <td><div class="drawing" id="svgRotateLeft"></div></td>
    <td><div class="drawing" id="svgRotateRight"></div></td>
  </tr>
  <tr>
	<td>Canvas</td>
    <td><div class="drawing" id="canvasRotateLeft"></div></td>
    <td><div class="drawing" id="canvasRotateRight"></div></td>
  </tr>
  <tr>
    <td></td>
    <td><span>'N' points to west?</span></td>
    <td><span>'N' points to east?</span></td>
  </tr>
</table>

<h1>Rotate, respecting the mouse pointer as fix-point</h1>
<div class="wrapper1">
  <div class="drawing" id="rotateMousePointer"></div>
</div>


<h1>Rotate, respecting a fix-point</h1>
<div>
  <form id="frotate">
    <input type="radio" name="dir" value="C" checked>Center<br>
    <input type="radio" name="dir" value="NE">Northeast<br>
    <input type="radio" name="dir" value="SE">Southeast<br>
    <input type="radio" name="dir" value="SW">Southwest<br>
    <input type="radio" name="dir" value="NW">Northwest<br>
  </form>
  <div class="drawing" id="rotateFixPoint"></div>
  <button id="brotateLeft">Rotate left</button>
  <button id="brotateRight">Rotate right</button>
</div>

<script type="text/javascript">



function test1RotateLeft() {
  var svgDrawing = getDrawingSvg('svgRotateLeft');
  svgDrawing.setBackgroundImage(url, function() {
    svgDrawing.getViewbox().rotateLeft();
    svgDrawing.draw();
  });
  var canvasDrawing = getDrawingCanvas('canvasRotateLeft');
  canvasDrawing.setBackgroundImage(url, function() {
    canvasDrawing.getViewbox().rotateLeft();
    canvasDrawing.draw();
  });
};



function test2RotateRight() {
  var svgDrawing = getDrawingSvg('svgRotateRight');
  svgDrawing.setBackgroundImage(url, function() {
    svgDrawing.getViewbox().rotateRight();
    svgDrawing.draw();
  });
  var canvasDrawing = getDrawingCanvas('canvasRotateRight');
  canvasDrawing.setBackgroundImage(url, function() {
    canvasDrawing.getViewbox().rotateRight();
    canvasDrawing.draw();
  });
};



function test3rotateMousePointer() {
  var canvas = new xrx.drawing.Drawing(goog.dom.getElement('rotateMousePointer'));
  canvas.setModeView();
  canvas.setBackgroundImage(url2);
};



function test4rotateFixPoint() {
  var canvas = new xrx.drawing.Drawing(goog.dom.getElement('rotateFixPoint'));
  var viewbox = canvas.getViewbox();

  // form
  var form = goog.dom.getElement('frotate');
  var fixPoint = function(reverse) {
    var element = goog.dom.findNode(form, function(n) {
      return goog.dom.isElement(n) && n.checked;
    });
    return viewbox.getPivotPoint(element.value, reverse);
  };

  // buttons
  var rotateLeft = goog.dom.getElement('brotateLeft');
  var rotateRight = goog.dom.getElement('brotateRight');
  goog.events.listen(rotateLeft, goog.events.EventType.CLICK, function() {
    viewbox.rotateBy(-90, fixPoint(true));
    canvas.draw();
  });
  goog.events.listen(rotateRight, goog.events.EventType.CLICK, function() {
    viewbox.rotateBy(90, fixPoint(false));
    canvas.draw();
  });

  // canvas and view-box configuration
  canvas.setModeView();
  canvas.getViewbox().setZoomMax(4);
  canvas.getViewbox().setZoomMin(.4);
  canvas.getViewbox().getCTM().translate(20, 20);
  canvas.setBackgroundImage(url2);
};

</script>
</body>
</html>
